defaults:
  - framework: betavae
  - model: conv64
  - optimizer: radam
  - dataset: xyscalecolorgrid
  # hydra plugins
  - hydra/job_logging: colorlog
  - hydra/hydra_logging: colorlog
  - hydra/launcher: submitit_slurm

# ------------------ #
# EXPERIMENT OPTIONS #
# ------------------ #

trainer:
  epochs: 100
  steps: null
  cuda: TRUE
  prepare_data_per_node: TRUE

model:
  z_size: 6

dataset:
  num_workers: 8
  batch_size: 256
  data_dir: '/tmp/${env:USER}/datasets'
  try_in_memory: TRUE

optimizer:
  lr: 1e-3

# --------------- #
# RUNTIME OPTIONS #
# --------------- #

logging:
  logs_dir: 'logs'
  wandb:
    enabled: TRUE
    name: '${framework.name}-${model.name}-${optimizer.name}-${dataset.name}'
    project: 'disentanglement'
    group: null
    entity: '${env:USER}'
    tags:
      - '${framework.name}'
      - '${model.name}'
      - '${optimizer.name}'
      - '${dataset.name}'

hydra:
  job:
    name: '${framework.name}-${model.name}-${optimizer.name}-${dataset.name}'
  launcher:
    params:
      partition: batch
      mem_gb: 0
      timeout_min: 120  # minutes
      submitit_folder: '${hydra.sweep.dir}/submitit/%j'
  run:
    dir: '${logging.logs_dir}/hydra_run/${now:%Y-%m-%d_%H-%M-%S}_${hydra.job.name}'
  sweep:
    dir: '${logging.logs_dir}/hydra_sweep/${now:%Y-%m-%d_%H-%M-%S}_${hydra.job.name}'
    subdir: '${hydra.job.id}'  # hydra.job.id is not available for dir
